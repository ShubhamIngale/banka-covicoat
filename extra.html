<!DOCTYPE HTML>
<html>

<head>
  <script src="https://code.jquery.com/jquery-3.0.0.min.js" integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0=" crossorigin="anonymous"></script>
  <!-- <script src='https://www.google.com/recaptcha/api.js'></script> -->
  <!-- <script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit&hl=fr" async defer></script> -->
  <script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit&hl=en" async defer></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.2/dist/jquery.validate.min.js"></script>
</head>
<body>
  <script>

                var onloadCallback = function(){
        grecaptcha.render("emplacementRecaptcha",{
            "sitekey": "6Ld4C7QZAAAAADHH0FdwovtA0snefc7ZE-txFrh5",
            "badge": "inline",
            "type": "image",
            "size": "invisible",
            "callback": onSubmit
        });
    };


    var onSubmit =function(token) {
        var contactForm = $("#contactForm");
        var name = $("#name").val();
    var email = $("#email").val();
    var message = $("#message").val();

//     contactForm.validate();

    $.ajax({
            type: 'POST',
            url: 'https://fistbumpmailer.herokuapp.com',
            data: {
                    name: name,
                    email: email,
                    message: message,
                    captcha: token
            },
            dataType: 'json',
            beforeSend: function() {
                    $("#submit").html('sending...');
            },
            success: function(response) {
                    console.log(response);
                    $("#submit").html('SEND');
            },
            error: function(err) {
                    console.log(err);
                    grecaptcha.reset();
            }
    })

    }

    function validate(event){
        event.preventDefault();
        grecaptcha.execute();
        $('#contactForm').validate();
    }
    function onload(){
        var element = document.getElementById("submit");
        element.onclick = validate;
    }


//   var contactForm = $("#contactForm");
//   //We set our own custom submit function
//   contactForm.on("submit", function(e) {
//     //Prevent the default behavior of a form
//     e.preventDefault();
//     //Get the values from the form
//     var name = $("#name").val();
//     var email = $("#email").val();
//     var message = $("#message").val();
//     //Our AJAX POST
//     $.ajax({
//       type: "POST",
//       url: "https://fistbumpmailer.herokuapp.com",
//       data: {
//         name: name,
//         email: email,
//         message: message,
//         //THIS WILL TELL THE FORM IF THE USER IS CAPTCHA VERIFIED.
//         captcha: grecaptcha.getResponse()
//       },
//       success: function(data) {
//         console.log("OUR FORM SUBMITTED CORRECTLY");
//         console.log(data)
//       }
//     })
//   });

  </script>


<form id="contactForm">
        <input type="text" id="name" placeholder="Your name..."/>
        <br>
        <input type="text" id="email" placeholder="Your email..."/>
        <br>
        <textarea id="message" placeholder="Your message..."></textarea>
        <br>
        <!-- <div class="g-recaptcha" data-sitekey="6Ld4C7QZAAAAADHH0FdwovtA0snefc7ZE-txFrh5"></div> -->
        <div id="emplacementRecaptcha"></div>
        <br>
        <!-- <input type="button" value="SEND" class="submit" /> -->
        <button type="submit" id="submit">SEND</button>
</form>
      <script>onload();</script>



</body>

</html>